<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Menu</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; min-height: 100vh; transition: background 0.5s; }
        body.dark { background: linear-gradient(135deg, #0f172a, #581c87, #0f172a); }
        body.light { background: linear-gradient(135deg, #eff6ff, #faf5ff, #fce7f3); }
        
        header { position: fixed; top: 0; left: 0; right: 0; z-index: 50; backdrop-filter: blur(20px); border-bottom: 1px solid; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 12px 16px; display: flex; align-items: center; justify-content: space-between; }
        body.dark header { background: rgba(255,255,255,0.1); border-color: rgba(168,85,247,0.3); }
        body.light header { background: rgba(255,255,255,0.7); border-color: rgba(168,85,247,0.5); }
        
        .logo { width: 40px; height: 40px; animation: spin 30s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .title { font-size: 20px; font-weight: bold; }
        body.dark .title { color: white; }
        body.light .title { color: #1e293b; }
        
        .hamburger { background: none; border: none; cursor: pointer; display: flex; flex-direction: column; gap: 5px; padding: 8px; }
        .hamburger span { width: 24px; height: 3px; background: white; border-radius: 2px; transition: 0.3s; }
        body.light .hamburger span { background: #1e293b; }
        .hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
        .hamburger.open span:nth-child(2) { opacity: 0; }
        .hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }
        
        .edit-banner { position: fixed; top: 64px; left: 0; right: 0; background: linear-gradient(90deg, #06b6d4, #a855f7); color: white; text-align: center; padding: 8px; font-size: 14px; font-weight: 600; z-index: 40; display: none; animation: pulse 2s infinite; }
        .edit-banner.show { display: block; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
        
        main { padding: 80px 16px 32px; max-width: 1200px; margin: 0 auto; }
        main.edit-mode { padding-top: 120px; }
        
        .empty { text-align: center; padding: 80px 16px; font-size: 18px; }
        body.dark .empty { color: rgba(255,255,255,0.6); }
        body.light .empty { color: #64748b; }
        
        .btn { padding: 12px 24px; background: linear-gradient(90deg, #06b6d4, #a855f7); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .btn:hover { transform: scale(1.05); }
        
        .grid { display: grid; gap: 16px; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
        
        .card { backdrop-filter: blur(16px); border-radius: 16px; padding: 24px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); cursor: pointer; transition: 0.3s; position: relative; }
        body.dark .card { background: rgba(255,255,255,0.1); }
        body.light .card { background: white; }
        .card:hover { transform: scale(1.05); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .card.dragging { opacity: 0.4; }
        
        .drag-handle { position: absolute; top: 8px; left: 8px; color: rgba(255,255,255,0.4); display: none; }
        .edit-mode .drag-handle { display: block; cursor: move; }
        
        .icon { font-size: 48px; text-align: center; margin-bottom: 16px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3)); }
        .card-title { font-size: 18px; font-weight: bold; text-align: center; margin-bottom: 8px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        body.dark .card-title { color: white; }
        body.light .card-title { color: #1e293b; }
        
        .card-url { font-size: 12px; text-align: center; margin-bottom: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        body.dark .card-url { color: #67e8f9; }
        body.light .card-url { color: #9333ea; }
        
        .actions { display: none; gap: 8px; justify-content: center; }
        .edit-mode .actions { display: flex; }
        .actions button { padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; color: white; transition: 0.2s; }
        .edit-btn { background: #3b82f6; }
        .edit-btn:hover { background: #2563eb; }
        .del-btn { background: #ef4444; }
        .del-btn:hover { background: #dc2626; }
        
        .sidebar { position: fixed; top: 0; right: 0; height: 100%; width: 320px; backdrop-filter: blur(20px); box-shadow: -4px 0 20px rgba(0,0,0,0.3); transform: translateX(100%); transition: 0.3s; z-index: 60; padding: 24px; }
        body.dark .sidebar { background: rgba(15,23,42,0.95); }
        body.light .sidebar { background: rgba(255,255,255,0.95); }
        .sidebar.open { transform: translateX(0); }
        
        .sidebar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
        .sidebar-title { font-size: 24px; font-weight: bold; }
        body.dark .sidebar-title { color: white; }
        body.light .sidebar-title { color: #1e293b; }
        
        .close-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
        body.dark .close-btn { color: white; }
        body.light .close-btn { color: #1e293b; }
        
        .menu { display: flex; flex-direction: column; gap: 16px; }
        .menu-btn { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 16px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        body.dark .menu-btn { background: rgba(255,255,255,0.1); color: white; }
        body.light .menu-btn { background: #f1f5f9; color: #1e293b; }
        body.dark .menu-btn:hover { background: rgba(255,255,255,0.2); }
        body.light .menu-btn:hover { background: #e2e8f0; }
        .menu-btn.active { background: linear-gradient(90deg, #06b6d4, #a855f7); color: white; }
        .menu-btn.danger { background: rgba(239,68,68,0.2); }
        body.dark .menu-btn.danger { color: #fca5a5; }
        body.light .menu-btn.danger { color: #dc2626; }
        
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); display: none; align-items: center; justify-content: center; z-index: 70; padding: 16px; }
        .modal-overlay.show { display: flex; }
        
        .modal { border-radius: 16px; box-shadow: 0 25px 50px rgba(0,0,0,0.5); max-width: 480px; width: 100%; padding: 24px; }
        body.dark .modal { background: #1e293b; }
        body.light .modal { background: white; }
        
        .modal-title { font-size: 24px; font-weight: bold; margin-bottom: 24px; }
        body.dark .modal-title { color: white; }
        body.light .modal-title { color: #1e293b; }
        
        .form-group { margin-bottom: 16px; }
        .label { display: block; font-size: 14px; font-weight: 600; margin-bottom: 8px; }
        body.dark .label { color: white; }
        body.light .label { color: #475569; }
        
        .input { width: 100%; padding: 12px 16px; border: none; border-radius: 12px; font-size: 16px; }
        body.dark .input { background: #334155; color: white; }
        body.light .input { background: #f1f5f9; color: #1e293b; }
        .input:focus { outline: 2px solid #a855f7; }
        
        .icon-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; }
        .icon-btn { padding: 12px; font-size: 24px; border: none; border-radius: 12px; cursor: pointer; transition: 0.2s; }
        body.dark .icon-btn { background: #334155; }
        body.light .icon-btn { background: #f1f5f9; }
        .icon-btn:hover { transform: scale(1.1); }
        .icon-btn.selected { background: linear-gradient(135deg, #06b6d4, #a855f7); transform: scale(1.1); }
        
        .modal-actions { display: flex; gap: 12px; margin-top: 24px; }
        .btn-sec { flex: 1; padding: 12px 24px; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        body.dark .btn-sec { background: #334155; color: white; }
        body.light .btn-sec { background: #e2e8f0; color: #1e293b; }
        
        .toast { position: fixed; bottom: 32px; left: 50%; transform: translateX(-50%) translateY(100px); background: linear-gradient(90deg, #06b6d4, #a855f7); color: white; padding: 12px 24px; border-radius: 50px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 80; transition: 0.3s; }
        .toast.show { transform: translateX(-50%) translateY(0); }
        
        .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 55; display: none; }
        .backdrop.show { display: block; }
    </style>
</head>
<body class="dark">
    <header>
        <svg class="logo" viewBox="0 0 100 100">
            <defs><linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#06b6d4"/><stop offset="100%" style="stop-color:#a855f7"/></linearGradient></defs>
            <circle cx="50" cy="50" r="45" fill="none" stroke="url(#g)" stroke-width="3"/>
            <text x="50" y="60" text-anchor="middle" fill="url(#g)" font-size="40" font-weight="bold" font-family="serif">DM</text>
        </svg>
        <h1 class="title">Dynamic Menu</h1>
        <button class="hamburger" id="ham"><span></span><span></span><span></span></button>
    </header>
    
    <div class="edit-banner" id="banner">‚ú® Edit Mode Active ‚Äì Drag to Rearrange</div>
    
    <main id="main">
        <div class="empty" id="empty">
            <p style="margin-bottom:16px">No menu items yet!</p>
            <button class="btn" onclick="openModal()">Add Your First Item</button>
        </div>
        <div class="grid" id="grid" style="display:none"></div>
    </main>
    
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">Menu</h2>
            <button class="close-btn" onclick="toggleSidebar()">‚úï</button>
        </div>
        <div class="menu">
            <button class="menu-btn" onclick="toggleTheme()"><span>Dark Mode</span><span id="themeIcon">üåô</span></button>
            <button class="menu-btn" id="editBtn" onclick="toggleEdit()"><span>Edit Mode</span><span>‚úèÔ∏è</span></button>
            <button class="menu-btn" onclick="openModal()"><span>Add New Item</span><span>‚ûï</span></button>
            <button class="menu-btn" onclick="save()"><span>Save Changes</span><span>üíæ</span></button>
            <button class="menu-btn" onclick="exportData()"><span>Export Menu</span><span>üì•</span></button>
            <button class="menu-btn danger" onclick="clearAll()"><span>Clear All</span><span>üóëÔ∏è</span></button>
        </div>
    </div>
    
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h2 class="modal-title" id="modalTitle">Add New Item</h2>
            <div class="form-group">
                <label class="label">Title</label>
                <input type="text" class="input" id="title" placeholder="e.g., Home Page">
            </div>
            <div class="form-group">
                <label class="label">URL</label>
                <input type="url" class="input" id="url" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label class="label">Icon</label>
                <div class="icon-grid" id="iconGrid"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-sec" onclick="closeModal()">Cancel</button>
                <button class="btn" onclick="submit()">Add</button>
            </div>
        </div>
    </div>
    
    <div class="backdrop" id="backdrop" onclick="toggleSidebar()"></div>
    <div class="toast" id="toast"></div>

    <script>
        let items = [];
        let editMode = false;
        let dark = true;
        let editId = null;
        let dragEl = null;
        let selIcon = 'home';
        
        const icons = {home:'üè†',info:'‚ÑπÔ∏è',briefcase:'üíº',mail:'‚úâÔ∏è',star:'‚≠ê',heart:'‚ù§Ô∏è',settings:'‚öôÔ∏è',user:'üë§',globe:'üåê',phone:'üìû',calendar:'üìÖ',book:'üìö'};
        
        function init() {
            const saved = sessionStorage.getItem('dynamicMenu');
            items = saved ? JSON.parse(saved) : [
                {id:1,title:'Home Page',url:'https://example.com',icon:'home'},
                {id:2,title:'About Us',url:'https://example.com/about',icon:'info'},
                {id:3,title:'Services',url:'https://example.com/services',icon:'briefcase'},
                {id:4,title:'Contact',url:'https://example.com/contact',icon:'mail'}
            ];
            renderIcons();
            render();
            document.getElementById('ham').onclick = toggleSidebar;
        }
        
        function render() {
            const empty = document.getElementById('empty');
            const grid = document.getElementById('grid');
            
            if (items.length === 0) {
                empty.style.display = 'block';
                grid.style.display = 'none';
                return;
            }
            
            empty.style.display = 'none';
            grid.style.display = 'grid';
            grid.innerHTML = '';
            
            items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.draggable = editMode;
                card.dataset.id = item.id;
                card.innerHTML = `
                    <div class="drag-handle">‚ãÆ‚ãÆ</div>
                    <div class="icon">${icons[item.icon]||'üìÑ'}</div>
                    <h3 class="card-title">${item.title}</h3>
                    <p class="card-url">${item.url}</p>
                    <div class="actions">
                        <button class="edit-btn" onclick="edit(${item.id})">‚úèÔ∏è</button>
                        <button class="del-btn" onclick="del(${item.id})">üóëÔ∏è</button>
                    </div>
                `;
                if (!editMode) card.onclick = () => window.open(item.url, '_blank');
                card.ondragstart = e => { dragEl = e.target; e.target.classList.add('dragging'); };
                card.ondragend = e => { e.target.classList.remove('dragging'); dragEl = null; };
                card.ondragover = e => e.preventDefault();
                card.ondrop = e => {
                    e.preventDefault();
                    if (!dragEl || dragEl === e.currentTarget) return;
                    const dragId = +dragEl.dataset.id, dropId = +e.currentTarget.dataset.id;
                    const dragIdx = items.findIndex(i => i.id === dragId);
                    const dropIdx = items.findIndex(i => i.id === dropId);
                    const [removed] = items.splice(dragIdx, 1);
                    items.splice(dropIdx, 0, removed);
                    saveData();
                    render();
                };
                grid.appendChild(card);
            });
        }
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('backdrop');
            const ham = document.getElementById('ham');
            const open = sidebar.classList.toggle('open');
            backdrop.classList.toggle('show', open);
            ham.classList.toggle('open', open);
        }
        
        function toggleTheme() {
            dark = !dark;
            document.body.className = dark ? 'dark' : 'light';
            document.getElementById('themeIcon').textContent = dark ? 'üåô' : '‚òÄÔ∏è';
        }
        
        function toggleEdit() {
            editMode = !editMode;
            document.getElementById('banner').classList.toggle('show', editMode);
            document.getElementById('main').classList.toggle('edit-mode', editMode);
            document.getElementById('editBtn').classList.toggle('active', editMode);
            render();
        }
        
        function openModal(id = null) {
            editId = id;
            const modal = document.getElementById('modalOverlay');
            const modalTitle = document.getElementById('modalTitle');
            const titleInput = document.getElementById('title');
            const urlInput = document.getElementById('url');
            
            if (id) {
                const item = items.find(i => i.id === id);
                modalTitle.textContent = 'Edit Item';
                titleInput.value = item.title;
                urlInput.value = item.url;
                selectIcon(item.icon);
            } else {
                modalTitle.textContent = 'Add New Item';
                titleInput.value = '';
                urlInput.value = '';
                selectIcon('home');
            }
            
            modal.classList.add('show');
            toggleSidebar();
        }
        
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('show');
            editId = null;
        }
        
        function renderIcons() {
            const grid = document.getElementById('iconGrid');
            Object.keys(icons).forEach(key => {
                const btn = document.createElement('button');
                btn.className = 'icon-btn';
                btn.textContent = icons[key];
                btn.dataset.icon = key;
                btn.onclick = () => selectIcon(key);
                grid.appendChild(btn);
            });
        }
        
        function selectIcon(icon) {
            selIcon = icon;
            document.querySelectorAll('.icon-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.dataset.icon === icon);
            });
        }
        
        function submit() {
            const title = document.getElementById('title').value.trim();
            const url = document.getElementById('url').value.trim();
            
            if (!title || !url) return alert('Please fill in all fields');
            if (!url.startsWith('http://') && !url.startsWith('https://')) return alert('URL must start with http:// or https://');
            
            if (editId) {
                const item = items.find(i => i.id === editId);
                item.title = title;
                item.url = url;
                item.icon = selIcon;
                toast('‚úèÔ∏è Item updated!');
            } else {
                items.push({id:Date.now(),title,url,icon:selIcon});
                toast('‚ûï Item added!');
            }
            
            saveData();
            render();
            closeModal();
        }
        
        function edit(id) { openModal(id); }
        
        function del(id) {
            if (!confirm('Delete this item?')) return;
            items = items.filter(i => i.id !== id);
            saveData();
            render();
            toast('üóëÔ∏è Item deleted');
        }
        
        function save() {
            saveData();
            toast('‚úÖ Changes saved!');
        }
        
        function saveData() {
            sessionStorage.setItem('dynamicMenu', JSON.stringify(items));
        }
        
        function exportData() {
            const data = 'data:application/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(items, null, 2));
            const a = document.createElement('a');
            a.href = data;
            a.download = 'dynamic-menu.json';
            a.click();
            toast('üì• Menu exported!');
        }
        
        function clearAll() {
            if (!confirm('Delete all items? This cannot be undone.')) return;
            items = [];
            saveData();
            render();
            toast('üóëÔ∏è All items cleared');
        }
        
        function toast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }
        
        init();
    </script>
</body>
</html>