<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TextSnap - Image Text Extractor</title>
    <script src="https://unpkg.com/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
    <style>
        :root {
            --primary-bg: #0a0a0a;
            --secondary-bg: #1a1a1a;
            --tertiary-bg: #2a2a2a;
            --primary-text: #ffffff;
            --secondary-text: #a0a0a0;
            --accent: #6366f1;
            --border: rgba(255, 255, 255, 0.1);
            --gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
            --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            --button-shadow: 0 4px 14px 0 rgba(99, 102, 241, 0.4);
            --transition: all 0.3s ease;
        }

        .light-mode {
            --primary-bg: #ffffff;
            --secondary-bg: #f8f9fa;
            --tertiary-bg: #e9ecef;
            --primary-text: #1a1a1a;
            --secondary-text: #6c757d;
            --border: rgba(0, 0, 0, 0.1);
            --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --button-shadow: 0 4px 14px 0 rgba(99, 102, 241, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background-color: var(--primary-bg);
            color: var(--primary-text);
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            transition: var(--transition);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .theme-toggle {
            background: var(--secondary-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--secondary-text);
            transition: var(--transition);
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .card {
            background: var(--secondary-bg);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--card-shadow);
            margin-bottom: 24px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .card:hover::before {
            transform: scaleX(1);
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        h1, h2, h3 {
            margin-bottom: 16px;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button {
            border: none;
            padding: 14px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            flex: 1;
            min-width: 140px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
            box-shadow: var(--button-shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5);
        }

        .btn-secondary {
            background: var(--tertiary-bg);
            color: var(--primary-text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            background: var(--secondary-bg);
        }

        .btn-gradient {
            background: var(--gradient);
            color: white;
            box-shadow: var(--button-shadow);
        }

        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5);
        }

        .btn-success {
            background: #10b981;
            color: white;
            box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.4);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
        }

        button:disabled {
            background: var(--tertiary-bg);
            color: var(--secondary-text);
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        #image-preview {
            max-width: 100%;
            max-height: 400px;
            margin: 0 auto 20px;
            display: block;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        #video-preview {
            max-width: 100%;
            max-height: 400px;
            margin: 0 auto 20px;
            display: none;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        #canvas {
            display: none;
        }

        #file-input {
            display: none;
        }

        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            height: 8px;
            background: var(--tertiary-bg);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--gradient);
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;
        }

        .status {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: var(--secondary-text);
        }

        #extracted-text {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            min-height: 200px;
            margin-top: 20px;
            background: var(--primary-bg);
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 400px;
            color: var(--primary-text);
            font-family: inherit;
            resize: vertical;
            width: 100%;
            transition: var(--transition);
        }

        #extracted-text:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }

        .alert {
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            display: none;
            border-left: 4px solid;
            background: var(--tertiary-bg);
        }

        .alert-error {
            border-left-color: #ef4444;
            color: #fca5a5;
        }

        .alert-success {
            border-left-color: #10b981;
            color: #a7f3d0;
        }

        .instructions {
            margin-top: 20px;
            padding: 20px;
            background: var(--tertiary-bg);
            border-radius: 12px;
            font-size: 14px;
            color: var(--secondary-text);
        }

        .instructions h3 {
            margin-bottom: 12px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(99, 102, 241, 0.2);
            color: var(--accent);
            margin-right: 8px;
            margin-bottom: 8px;
        }

        @media (max-width: 600px) {
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo floating">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12H15M9 16H15M9 20H15M5 4H19C20.1046 4 21 4.89543 21 6V18C21 19.1046 20.1046 20 19 20H5C3.89543 20 3 19.1046 3 18V6C3 4.89543 3.89543 4 5 4Z" stroke="url(#gradient)" stroke-width="2" stroke-linecap="round"/>
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#6366f1"/>
                        <stop offset="50%" stop-color="#8b5cf6"/>
                        <stop offset="100%" stop-color="#ec4899"/>
                    </linearGradient>
                </defs>
            </svg>
            TextSnap
        </div>
        <button class="theme-toggle" id="theme-toggle">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 2V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 20V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4.93 4.93L6.34 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M17.66 17.66L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M2 12H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M20 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6.34 17.66L4.93 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19.07 4.93L17.66 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span id="theme-text">Light Mode</span>
        </button>
    </header>

    <div class="card fade-in">
        <h2>Capture or Upload Image</h2>
        <p style="color: var(--secondary-text); margin-bottom: 20px;">Take a picture or upload an existing image to extract text</p>
        
        <div class="button-group">
            <button id="capture-btn" class="btn-gradient">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M23 19C23 19.5304 22.7893 20.0391 22.4142 20.4142C22.0391 20.7893 21.5304 21 21 21H3C2.46957 21 1.96086 20.7893 1.58579 20.4142C1.21071 20.0391 1 19.5304 1 19V8C1 7.46957 1.21071 6.96086 1.58579 6.58579C1.96086 6.21071 2.46957 6 3 6H7L9 3H15L17 6H21C21.5304 6 22.0391 6.21071 22.4142 6.58579C22.7893 6.96086 23 7.46957 23 8V19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 17C14.2091 17 16 15.2091 16 13C16 10.7909 14.2091 9 12 9C9.79086 9 8 10.7909 8 13C8 15.2091 9.79086 17 12 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Take Picture
            </button>
            <button id="upload-btn" class="btn-secondary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M17 8L12 3L7 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Upload Image
            </button>
            <input type="file" id="file-input" accept="image/*">
        </div>

        <video id="video-preview" autoplay playsinline></video>
        <img id="image-preview" alt="Image preview" class="fade-in">
        <canvas id="canvas"></canvas>

        <div class="button-group">
            <button id="capture-confirm-btn" class="btn-primary" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21 12C21 13.1819 20.7672 14.3522 20.3149 15.4442C19.8626 16.5361 19.1997 17.5282 18.364 18.364C17.5282 19.1997 16.5361 19.8626 15.4442 20.3149C14.3522 20.7672 13.1819 21 12 21C10.8181 21 9.64778 20.7672 8.55585 20.3149C7.46392 19.8626 6.47177 19.1997 5.63604 18.364C4.80031 17.5282 4.13738 16.5361 3.68508 15.4442C3.23279 14.3522 3 13.1819 3 12C3 9.61305 3.94821 7.32387 5.63604 5.63604C7.32387 3.94821 9.61305 3 12 3C14.3869 3 16.6761 3.94821 18.364 5.63604C20.0518 7.32387 21 9.61305 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Capture Image
            </button>
            <button id="extract-btn" class="btn-primary" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Extract Text
            </button>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
            <div class="status" id="progress-status">Initializing...</div>
        </div>

        <div class="alert alert-error" id="error-message"></div>
        <div class="alert alert-success" id="success-message"></div>
    </div>

    <div class="card fade-in">
        <h2>Extracted Text</h2>
        <p style="color: var(--secondary-text); margin-bottom: 20px;">Edit the extracted text as needed, then copy to clipboard</p>
        
        <textarea id="extracted-text" placeholder="Extracted text will appear here..."></textarea>
        
        <div class="button-group" style="margin-top: 20px;">
            <button id="copy-btn" class="btn-success">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 16H6C5.46957 16 4.96086 15.7893 4.58579 15.4142C4.21071 15.0391 4 14.5304 4 14V6C4 5.46957 4.21071 4.96086 4.58579 4.58579C4.96086 4.21071 5.46957 4 6 4H14C14.5304 4 15.0391 4.21071 15.4142 4.58579C15.7893 4.96086 16 5.46957 16 6V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 20H18C18.5304 20 19.0391 19.7893 19.4142 19.4142C19.7893 19.0391 20 18.5304 20 18V10C20 9.46957 19.7893 8.96086 19.4142 8.58579C19.0391 8.21071 18.5304 8 18 8H10C9.46957 8 8.96086 8.21071 8.58579 8.58579C8.21071 8.96086 8 9.46957 8 10V18C8 18.5304 8.21071 19.0391 8.58579 19.4142C8.96086 19.7893 9.46957 20 10 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Copy Text
            </button>
        </div>
    </div>

    <div class="instructions card fade-in">
        <h3>How to Use</h3>
        <ol>
            <li>Take a picture using your camera or upload an image from your device</li>
            <li>Click "Extract Text" to process the image with OCR</li>
            <li>Edit the extracted text in the text area to fix any recognition errors</li>
            <li>Click "Copy Text" to copy the edited text to your clipboard</li>
        </ol>
        <div style="margin-top: 16px;">
            <span class="badge">Tip</span> For best results, use clear images with high contrast text
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const themeToggle = document.getElementById('theme-toggle');
            const themeText = document.getElementById('theme-text');
            const captureBtn = document.getElementById('capture-btn');
            const uploadBtn = document.getElementById('upload-btn');
            const fileInput = document.getElementById('file-input');
            const videoPreview = document.getElementById('video-preview');
            const imagePreview = document.getElementById('image-preview');
            const canvas = document.getElementById('canvas');
            const captureConfirmBtn = document.getElementById('capture-confirm-btn');
            const extractBtn = document.getElementById('extract-btn');
            const progressContainer = document.querySelector('.progress-container');
            const progressBar = document.getElementById('progress-bar');
            const progressStatus = document.getElementById('progress-status');
            const extractedText = document.getElementById('extracted-text');
            const copyBtn = document.getElementById('copy-btn');
            const errorMessage = document.getElementById('error-message');
            const successMessage = document.getElementById('success-message');

            let stream = null;
            let currentImageData = null;

            // Theme toggle functionality
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('light-mode');
                if (document.body.classList.contains('light-mode')) {
                    themeText.textContent = 'Dark Mode';
                } else {
                    themeText.textContent = 'Light Mode';
                }
            });

            // Event listeners
            captureBtn.addEventListener('click', startCamera);
            uploadBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileUpload);
            captureConfirmBtn.addEventListener('click', captureImage);
            extractBtn.addEventListener('click', extractTextFromImage);
            copyBtn.addEventListener('click', copyText);

            // Start camera for capturing image
            async function startCamera() {
                try {
                    hideMessages();
                    stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' } 
                    });
                    
                    videoPreview.srcObject = stream;
                    videoPreview.style.display = 'block';
                    imagePreview.style.display = 'none';
                    
                    captureConfirmBtn.style.display = 'flex';
                    extractBtn.style.display = 'none';
                } catch (err) {
                    showError('Camera access denied or not available: ' + err.message);
                }
            }

            // Handle file upload
            function handleFileUpload(event) {
                hideMessages();
                const file = event.target.files[0];
                if (!file) return;
                
                if (!file.type.match('image.*')) {
                    showError('Please select an image file');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    videoPreview.style.display = 'none';
                    
                    captureConfirmBtn.style.display = 'none';
                    extractBtn.style.display = 'flex';
                    
                    currentImageData = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            // Capture image from camera
            function captureImage() {
                if (!stream) return;
                
                const context = canvas.getContext('2d');
                canvas.width = videoPreview.videoWidth;
                canvas.height = videoPreview.videoHeight;
                context.drawImage(videoPreview, 0, 0, canvas.width, canvas.height);
                
                currentImageData = canvas.toDataURL('image/png');
                imagePreview.src = currentImageData;
                imagePreview.style.display = 'block';
                videoPreview.style.display = 'none';
                
                // Stop camera stream
                stream.getTracks().forEach(track => track.stop());
                stream = null;
                
                captureConfirmBtn.style.display = 'none';
                extractBtn.style.display = 'flex';
            }

            // Extract text from image using Tesseract.js
            async function extractTextFromImage() {
                if (!currentImageData) {
                    showError('No image available for text extraction');
                    return;
                }
                
                try {
                    hideMessages();
                    progressContainer.style.display = 'block';
                    extractBtn.disabled = true;
                    
                    const result = await Tesseract.recognize(
                        currentImageData,
                        'eng',
                        {
                            logger: progress => {
                                if (progress.status === 'recognizing text') {
                                    const p = Math.round(progress.progress * 100);
                                    progressBar.style.width = `${p}%`;
                                    progressStatus.textContent = `Processing: ${p}%`;
                                } else {
                                    progressStatus.textContent = progress.status;
                                }
                            }
                        }
                    );
                    
                    extractedText.value = result.data.text || 'No text detected in the image';
                    showSuccess('Text extraction completed successfully! You can now edit the text.');
                } catch (err) {
                    showError('Error during text extraction: ' + err.message);
                } finally {
                    progressContainer.style.display = 'none';
                    extractBtn.disabled = false;
                }
            }

            // Copy text to clipboard
            function copyText() {
                if (!extractedText.value || extractedText.value === 'No text detected in the image') {
                    showError('No text available to copy');
                    return;
                }
                
                navigator.clipboard.writeText(extractedText.value)
                    .then(() => {
                        showSuccess('Text copied to clipboard!');
                    })
                    .catch(err => {
                        showError('Failed to copy text: ' + err.message);
                    });
            }

            // Helper functions for messages
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
            }

            function showSuccess(message) {
                successMessage.textContent = message;
                successMessage.style.display = 'block';
                errorMessage.style.display = 'none';
            }

            function hideMessages() {
                errorMessage.style.display = 'none';
                successMessage.style.display = 'none';
            }
        });
    </script>
</body>
</html>